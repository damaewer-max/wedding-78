<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

<title>Свадьба Александра и Анастасии</title>

<link href="https://fonts.googleapis.com/css2?family=Marck+Script&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root{
  --blue:#eaf5ff;
  --accent:#a8d8ff;
}

body{
  margin:0;
  font-family:'Montserrat',sans-serif;
  background:
    linear-gradient(rgba(255,255,255,.8),rgba(255,255,255,.95)),
    url("photo.jpg") center/cover fixed no-repeat;
  color:#2b2b2b;
}

/* карточка */
.card{
  max-width:820px;
  margin:40px auto;
  padding:35px;
  background:#ffffffee;
  border-radius:22px;
  box-shadow:0 10px 40px rgba(0,0,0,.12);
  text-align:center;
}

h1,h2{
  font-family:'Marck Script',cursive;
}

input,select{
  width:95%;
  padding:12px;
  margin:6px 0;
  border-radius:12px;
  border:1px solid #ddd;
  font-size:15px;
}

/* ошибка поля */
input.error{
  border:2px solid #ff6b6b;
  background:#fff1f1;
}

.buttons{
  display:flex;
  gap:10px;
  justify-content:center;
}

button{
  padding:14px 26px;
  border:none;
  border-radius:14px;
  font-size:16px;
  cursor:pointer;
  background:var(--accent);
}

.yes{background:#a8d8ff}
.no{background:#f4c6c6}

/* уведомление */
.toast{
  position:fixed;
  bottom:30px;
  left:50%;
  transform:translateX(-50%);
  background:#ff6b6b;
  color:white;
  padding:14px 24px;
  border-radius:14px;
  opacity:0;
  transition:.4s;
  pointer-events:none;
}

.toast.show{
  opacity:1;
}

.notice{
  background:#fff4f4;
  border:2px solid #ffd1d1;
  padding:16px;
  border-radius:16px;
  margin-bottom:20px;
}

.total{
  margin-top:10px;
  font-weight:600;
  color:#4d7fb3;
}
</style>
</head>

<body>

<div class="card">

<h1>Подтвердите присутствие</h1>

<div class="notice">
<b>❗ Важно</b><br>
Пожалуйста, укажите имена и фамилии всех гостей и точное количество человек.<br>
Это очень важно для организации праздника. Спасибо за понимание ❤️
</div>

<input id="name" placeholder="Имя и фамилия (например: Иван Петров)">
<input id="count" type="number" value="1" min="1">

<select id="transfer">
<option>Трансфер не нужен</option>
<option>Только до торжества</option>
<option>Только после торжества</option>
<option>До и после торжества</option>
</select>

<select id="food">
<option>Нет особенностей</option>
<option>Не ем мясо</option>
<option>Не ем рыбу</option>
<option>Вегетарианец</option>
</select>

<select id="alcohol">
<option>Красное вино</option>
<option>Белое вино</option>
<option>Шампанское</option>
<option>Виски/коньяк</option>
<option>Водка</option>
<option>Не буду пить алкоголь</option>
</select>

<select id="kids">
<option>Без ребёнка</option>
<option>С ребёнком</option>
</select>

<div class="buttons">
<button class="yes" onclick="saveAnswer('Да')">Приду</button>
<button class="no" onclick="saveAnswer('Нет')">Не смогу</button>
</div>

<div id="totalGuests" class="total"></div>

<button onclick="adminDownload()">Скачать ответы</button>

</div>

<div id="toast" class="toast"></div>

<script>
/* уведомление */
function showToast(text){
  toast.textContent=text;
  toast.classList.add("show");
  setTimeout(()=>toast.classList.remove("show"),3000);
}

/* проверка имени */
function validateName(){
  const val=name.value.trim();

  if(val.split(/\s+/).length < 2){
    name.classList.add("error");
    showToast("Пожалуйста, укажите имя и фамилию");
    name.focus();
    return false;
  }

  name.classList.remove("error");
  return true;
}

/* сохранение */
function saveAnswer(ans){

  if(!validateName()) return;

  const data=JSON.parse(localStorage.getItem("wedding"))||[];

  data.push({
    name:name.value,
    guests:count.value,
    answer:ans,
    transfer:transfer.value,
    food:food.value,
    alcohol:alcohol.value,
    kids:kids.value,
    time:new Date().toLocaleString("ru-RU")
  });

  localStorage.setItem("wedding",JSON.stringify(data));
  updateTotal();
  showToast("Ответ сохранён ❤️ see you!");
}

/* подсчёт */
function updateTotal(){
  const data=JSON.parse(localStorage.getItem("wedding"))||[];
  let sum=0;
  data.forEach(r=>{
    if(r.answer==="Да") sum+=Number(r.guests);
  });
  totalGuests.textContent="Всего подтвердили: "+sum+" гостей";
}

/* пароль */
function adminDownload(){
  const pass=prompt("Введите пароль");
  if(pass==="3005") downloadCSV();
}

/* Excel */
function downloadCSV(){
  const data=JSON.parse(localStorage.getItem("wedding"))||[];

  const rows=[["Имя","Гостей","Ответ","Трансфер","Питание","Алкоголь","Ребёнок","Время"]];

  data.forEach(r=>{
    rows.push([r.name,r.guests,r.answer,r.transfer,r.food,r.alcohol,r.kids,r.time]);
  });

  const csv=rows.map(r=>r.join(";")).join("\n");

  const blob=new Blob(["\uFEFF"+csv],{type:"text/csv;charset=utf-8;"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="answers.csv";
  a.click();
}

updateTotal();
</script>

</body>
</html>


